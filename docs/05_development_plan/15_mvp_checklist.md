# 05_development_plan/15_mvp_checklist.md
# MVPチェックリスト — Strategy Bricks（仮称）

## 0. ドキュメント情報
- ファイル名：`docs/05_development_plan/15_mvp_checklist.md`
- 版：v1.0
- 対象：実装担当・プロジェクトマネージャー
- 目的：MVP実装の進捗管理とタスク漏れ防止

---

## 1. 概要と使い方

このチェックリストは、Strategy BricksのMVP実装を段階的に進めるためのタスクリストです。

### 1.1 フェーズ構成

| Phase | 名称 | 期間目安 | 完了条件 |
|-------|------|----------|---------|
| Phase 0 | 契約確定 | 1-2日 | 未決事項ゼロ、契約書完成 |
| Phase 1 | EA Runtime MVP | 5-7日 | MVPブロック動作、ログ出力 |
| Phase 2 | GUI Builder MVP | 5-7日 | 設定出力、検証機能 |
| Phase 3 | 統合検証 | 3-5日 | 受入基準AC-01〜AC-11達成 |
| Phase 4 | 安全装置 | 3-5日 | リスクガード、運用マニュアル整備 |

**合計期間**: 17-26日

### 1.2 チェックリストの使い方

**記法:**
- ✅ 完了
- ⬜ 未着手
- 🚧 作業中
- ⚠️ ブロック中（依存タスク未完了）

**更新ルール:**
- タスク完了時に✅をマーク
- 完了日を記入
- 問題があればNotesに記載

---

## 2. Phase 0: 契約確定

**目的**: 実装の基盤となる契約（スキーマ、インターフェース）を完全に確定

**開始条件**: なし（最初のフェーズ）

**完了条件**:
- 未決事項A1-A5が全て決定済み
- D1, D2, D3のドキュメントが完成
- プロトタイプ検証（EA/GUI）が成功

### 2.1 未決事項の決定（A1-A5）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| A1: ポジション管理タイミングの決定 | ✅ | - | 2026-01-22 | 新バーのみに決定 |
| A2: IndicatorCacheハンドル生成タイミングの決定 | ✅ | - | 2026-01-22 | OnInit時に決定 |
| A3: OrderExecutor発注モードの決定 | ✅ | - | 2026-01-22 | 同期発注に決定 |
| A4: Nanpinモードの詳細ルールの決定 | ✅ | - | 2026-01-22 | MVP段階ではoff固定 |
| A5: Strategy競合解決ポリシーの決定 | ✅ | - | 2026-01-22 | firstOnly固定 |
| 00_overview.mdの未決事項セクション更新 | ✅ | - | 2026-01-22 | 決定事項を反映 |

### 2.2 必須ドキュメントの作成（D1-D3）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| D1: インターフェース契約書（45_interface_contracts.md）作成 | ✅ | - | 2026-01-22 | Context/IBlock/IndicatorCache等を完全定義 |
| D2: ログイベント仕様書（85_log_event_spec.md）作成 | ✅ | - | 2026-01-22 | 全イベント種別を完全定義 |
| D3: MVPチェックリスト（15_mvp_checklist.md）作成 | ✅ | - | 2026-01-22 | Phase 0-4の全タスクをリスト化 |

### 2.3 既存ドキュメントのレビュー

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| strategy_config.json v1（30_config_spec.md）のレビュー | ⬜ | - | - | 未決事項の反映確認 |
| block_catalog.json（40_block_catalog_spec.md）のレビュー | ⬜ | - | - | MVPブロックセット確認 |
| EA Runtime設計（50_ea_runtime_design.md）のレビュー | ⬜ | - | - | 未決事項の反映確認 |
| GUI Builder設計（60_gui_builder_design.md）のレビュー | ⬜ | - | - | 未決事項の反映確認 |
| 受入基準（12_acceptance_criteria.md）のレビュー | ⬜ | - | - | AC-01〜AC-11がMVP範囲か確認 |

### 2.4 プロトタイプ検証（EA）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| 最小限のEA骨格実装（OnInit/OnTick/OnDeinit） | ⬜ | - | - | 200行程度 |
| strategy_config.json読み込み実装 | ⬜ | - | - | ファイル読込＋JSON解析 |
| IndicatorCacheハンドル生成実装 | ⬜ | - | - | iMA()テスト |
| 新バー検知実装（NewBarDetector） | ⬜ | - | - | M1固定 |
| JSONL形式のログ出力実装 | ⬜ | - | - | BAR_EVAL_STARTのみ |
| バックテストで動作確認 | ⬜ | - | - | 1時間×60回のBAR_EVAL_START |
| プロトタイプ検証レポート作成 | ⬜ | - | - | 成功/失敗の判定 |

### 2.5 プロトタイプ検証（GUI）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| Electronプロジェクト初期化 | ⬜ | - | - | npm init, electron設定 |
| React + React Flowの導入 | ⬜ | - | - | 依存関係インストール |
| block_catalog.json読み込み実装 | ⬜ | - | - | カタログ読込テスト |
| paramsSchema→フォーム自動生成の実装 | ⬜ | - | - | number/select等の基本型 |
| strategy_config.json出力実装 | ⬜ | - | - | JSON.stringify() |
| 動作確認（起動→読込→出力） | ⬜ | - | - | - |
| GUI技術検証レポート作成 | ⬜ | - | - | 成功/失敗の判定 |

### 2.6 Phase 0完了確認

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| 未決事項A1-A5が全て決定済みか確認 | ⬜ | - | - | - |
| D1, D2, D3のドキュメントが完成しているか確認 | ⬜ | - | - | - |
| プロトタイプ検証（EA）が成功しているか確認 | ⬜ | - | - | - |
| プロトタイプ検証（GUI）が成功しているか確認 | ⬜ | - | - | - |
| Phase 1開始承認 | ⬜ | PM | - | - |

**Phase 0完了日**: ___________

---

## 3. Phase 1: EA Runtime MVP

**目的**: EA Runtimeの基本機能を実装し、MVPブロックで動作させる

**開始条件**: Phase 0完了

**完了条件**:
- MVPブロックが動作
- ログが仕様通りに出力される
- 新バー評価・同一足禁止が機能

### 3.1 コア実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| プロジェクト構造の作成 | ⬜ | - | - | ea/src/, ea/include/等 |
| Config構造体の定義 | ⬜ | - | - | 45_interface_contracts.md準拠 |
| Context構造体の定義 | ⬜ | - | - | 同上 |
| BlockResult構造体の定義 | ⬜ | - | - | 同上 |
| IBlockインターフェースの定義 | ⬜ | - | - | 同上 |

### 3.2 ConfigLoader実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| ファイル読込処理（FileOpen/FileRead） | ⬜ | - | - | - |
| JSON解析処理 | ⬜ | - | - | MQL5のJSON機能またはカスタム |
| Config構造体への格納 | ⬜ | - | - | - |
| エラーハンドリング（ファイルなし、解析失敗） | ⬜ | - | - | - |
| ログ出力（CONFIG_LOADED） | ⬜ | - | - | - |

### 3.3 Validator実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| formatVersionチェック | ⬜ | - | - | v1.0のみサポート |
| 必須フィールドチェック | ⬜ | - | - | timeframe=M1等 |
| ブロック参照チェック | ⬜ | - | - | blockId存在確認 |
| エラーログ出力（CONFIG_ERROR） | ⬜ | - | - | - |
| 検証失敗時にINIT_FAILED返却 | ⬜ | - | - | - |

### 3.4 NewBarDetector実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| IsNewBar()実装 | ⬜ | - | - | M1固定、iTime()使用 |
| static変数で前回バー時刻保持 | ⬜ | - | - | - |
| エラーハンドリング（iTime失敗） | ⬜ | - | - | - |
| ログ出力（BAR_EVAL_START） | ⬜ | - | - | - |
| テスト: 1時間で60回のBAR_EVAL_START | ⬜ | - | - | AC-01対応 |

### 3.5 IndicatorCache実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| ハンドルキャッシュ構造の実装 | ⬜ | - | - | HandleCacheEntry配列 |
| 値キャッシュ構造の実装 | ⬜ | - | - | ValueCacheEntry配列 |
| GetMAHandle()実装 | ⬜ | - | - | iMA()呼出、キャッシュ |
| GetMAValue()実装 | ⬜ | - | - | CopyBuffer()、値キャッシュ |
| GetBBHandle()実装 | ⬜ | - | - | iBands()呼出 |
| GetBBValue()実装 | ⬜ | - | - | CopyBuffer() |
| ClearValueCache()実装 | ⬜ | - | - | 新バー時にクリア |
| Cleanup()実装 | ⬜ | - | - | OnDeinit時のハンドル解放 |
| エラーハンドリング（INVALID_HANDLE、CopyBuffer失敗） | ⬜ | - | - | ログ出力、安全側停止 |
| テスト: ハンドル共有の確認 | ⬜ | - | - | 同一パラメータで同一ハンドル |

### 3.6 BlockRegistry実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| RegisterMVPBlocks()実装 | ⬜ | - | - | MVPブロック8種を登録 |
| CreateBlock()実装 | ⬜ | - | - | typeId→インスタンス生成 |
| エラーハンドリング（未知のtypeId） | ⬜ | - | - | ログ出力 |

### 3.7 MVPブロック実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| filter.spreadMax実装 | ⬜ | - | - | スプレッドチェック |
| env.session.timeWindow実装 | ⬜ | - | - | 時間帯・曜日チェック |
| trend.maRelation実装 | ⬜ | - | - | M1のClose vs MA |
| trigger.bbReentry実装 | ⬜ | - | - | 確定足で外→内回帰 |
| lot.fixed実装 | ⬜ | - | - | 固定ロット返却 |
| risk.fixedSLTP実装 | ⬜ | - | - | 固定pipsのSL/TP |
| exit.none実装 | ⬜ | - | - | 何もしない |
| nanpin.off実装 | ⬜ | - | - | 何もしない |
| 全ブロックのshift=1統一確認 | ⬜ | - | - | 確定足のみ使用 |
| 全ブロックのreason文字列確認 | ⬜ | - | - | 人間可読な理由 |
| テスト: 各ブロックの単体動作確認 | ⬜ | - | - | - |

### 3.8 CompositeEvaluator実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| EvaluateOR()実装 | ⬜ | - | - | 短絡評価 |
| EvaluateAND()実装 | ⬜ | - | - | 短絡評価 |
| EvaluateBlock()実装 | ⬜ | - | - | BlockRegistry使用 |
| BuildContext()実装 | ⬜ | - | - | Context構築 |
| ログ出力（RULEGROUP_EVAL、BLOCK_EVAL） | ⬜ | - | - | - |
| テスト: OR短絡評価の確認 | ⬜ | - | - | AC-03対応 |
| テスト: AND短絡評価の確認 | ⬜ | - | - | AC-03対応 |

### 3.9 StrategyEngine実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| SortStrategies()実装 | ⬜ | - | - | priority降順 |
| EvaluateStrategies()実装 | ⬜ | - | - | priority順評価 |
| ExecuteStrategy()実装 | ⬜ | - | - | ロット・SL/TP計算→発注 |
| firstOnlyポリシー実装 | ⬜ | - | - | 最初の成立で終了 |
| ログ出力（STRATEGY_EVAL） | ⬜ | - | - | - |
| テスト: priority順評価の確認 | ⬜ | - | - | AC-18対応 |

### 3.10 OrderExecutor実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| Execute()実装 | ⬜ | - | - | 同期発注 |
| 同一足再エントリーチェック（第二ガード） | ⬜ | - | - | lastEntryBarTime比較 |
| ValidateLot()実装 | ⬜ | - | - | ブローカー制約チェック |
| ValidateSLTP()実装 | ⬜ | - | - | ストップレベルチェック |
| OrderSend()呼出 | ⬜ | - | - | MqlTradeRequest構築 |
| lastEntryBarTime更新 | ⬜ | - | - | 発注成功時 |
| ログ出力（ORDER_ATTEMPT、ORDER_RESULT、ORDER_REJECT） | ⬜ | - | - | - |
| テスト: 同一足再エントリー禁止の確認 | ⬜ | - | - | AC-02対応 |
| テスト: ロット検証の確認 | ⬜ | - | - | AC-15対応 |
| テスト: SL/TP検証の確認 | ⬜ | - | - | AC-16対応 |

### 3.11 PositionManager実装（基本）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| ManagePositions()実装 | ⬜ | - | - | 新バーのみ呼出 |
| ApplyExitModel()実装（exit.noneのみ） | ⬜ | - | - | 何もしない |
| ログ出力（MANAGEMENT_ACTION） | ⬜ | - | - | - |

### 3.12 StateStore実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| Initialize()実装 | ⬜ | - | - | グローバル変数から復元 |
| Persist()実装 | ⬜ | - | - | グローバル変数に保存 |
| GetLastEntryBarTime()実装 | ⬜ | - | - | - |
| SetLastEntryBarTime()実装 | ⬜ | - | - | - |

### 3.13 Logger実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| Initialize()実装 | ⬜ | - | - | 日次ローテーション |
| WriteLine()実装 | ⬜ | - | - | JSONL形式出力 |
| EscapeJSON()実装 | ⬜ | - | - | 文字列エスケープ |
| LogConfigLoaded()実装 | ⬜ | - | - | - |
| LogBarEvalStart()実装 | ⬜ | - | - | - |
| LogStrategyEval()実装 | ⬜ | - | - | - |
| LogRuleGroupEval()実装 | ⬜ | - | - | - |
| LogBlockEval()実装 | ⬜ | - | - | - |
| LogOrderAttempt()実装 | ⬜ | - | - | - |
| LogOrderResult()実装 | ⬜ | - | - | - |
| LogOrderReject()実装 | ⬜ | - | - | - |
| LogIndicatorError()実装 | ⬜ | - | - | - |
| LogConfigError()実装 | ⬜ | - | - | - |
| Cleanup()実装 | ⬜ | - | - | OnDeinit時のファイルクローズ |
| テスト: JSONL形式の検証 | ⬜ | - | - | jqで解析可能 |

### 3.14 OnInit/OnTick/OnDeinit統合

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| OnInit()実装 | ⬜ | - | - | 初期化フロー統合 |
| OnTick()実装 | ⬜ | - | - | 実行フロー統合 |
| OnDeinit()実装 | ⬜ | - | - | クリーンアップ |
| ポジション制限チェック実装 | ⬜ | - | - | maxPositionsTotal等 |
| ログ出力（LIMIT_EXCEEDED） | ⬜ | - | - | - |
| テスト: ポジション制限超過時の挙動 | ⬜ | - | - | AC-04対応 |

### 3.15 Phase 1完了確認

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| active.jsonを読込できるか確認 | ⬜ | - | - | - |
| MVPブロックが動作するか確認 | ⬜ | - | - | - |
| ログが仕様通りに出力されるか確認 | ⬜ | - | - | JSONL形式 |
| 新バー評価が1分に1回か確認 | ⬜ | - | - | AC-01 |
| 同一足再エントリー禁止が機能するか確認 | ⬜ | - | - | AC-02 |
| OR/AND短絡評価が機能するか確認 | ⬜ | - | - | AC-03 |
| Phase 2開始承認 | ⬜ | PM | - | - |

**Phase 1完了日**: ___________

---

## 4. Phase 2: GUI Builder MVP

**目的**: GUI Builderの基本機能を実装し、設定出力を可能にする

**開始条件**: Phase 1完了（EA Runtimeと並行可）

**完了条件**:
- profiles/<name>.json + active.json を出力できる
- バリデーション機能が動作
- paramsSchemaからフォーム自動生成

### 4.1 プロジェクト構造の作成

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| Electronプロジェクト初期化 | ⬜ | - | - | npm init, electron |
| React + TypeScriptセットアップ | ⬜ | - | - | webpack/vite等 |
| React Flowの導入 | ⬜ | - | - | ノードベースエディタ |
| プロジェクト構造（src/components/等） | ⬜ | - | - | - |

### 4.2 Palette実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| block_catalog.json読み込み | ⬜ | - | - | - |
| カテゴリ別ブロック一覧表示 | ⬜ | - | - | filter/env/trend/trigger等 |
| ドラッグ&ドロップ対応 | ⬜ | - | - | Canvasへ配置 |
| ブロック詳細表示（displayName、description） | ⬜ | - | - | ツールチップ |

### 4.3 Canvas実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| React Flowのセットアップ | ⬜ | - | - | - |
| ノード配置（ブロック） | ⬜ | - | - | - |
| エッジ接続（OR/AND制約） | ⬜ | - | - | 枠がOR、内がAND |
| ノード選択・編集 | ⬜ | - | - | クリックでPropertyPanel表示 |
| ノード削除 | ⬜ | - | - | - |
| UI制約の実装（OR/ANDルール） | ⬜ | - | - | 不正な接続を拒否 |

### 4.4 PropertyPanel実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| paramsSchemaの読み込み | ⬜ | - | - | 選択ブロックのスキーマ |
| フォーム自動生成（number） | ⬜ | - | - | <input type="number"> |
| フォーム自動生成（select） | ⬜ | - | - | <select> |
| フォーム自動生成（checkbox） | ⬜ | - | - | <input type="checkbox"> |
| フォーム自動生成（timeWindow） | ⬜ | - | - | カスタムコンポーネント |
| パラメータ変更時の反映 | ⬜ | - | - | リアルタイム更新 |
| 必須パラメータのバリデーション | ⬜ | - | - | 未入力時エラー表示 |

### 4.5 Validator実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| 必須パラメータチェック | ⬜ | - | - | AC-06対応 |
| 型チェック | ⬜ | - | - | AC-24対応 |
| 範囲チェック（minimum/maximum） | ⬜ | - | - | AC-25対応 |
| ブロック参照チェック | ⬜ | - | - | AC-23対応 |
| 循環参照チェック | ⬜ | - | - | - |
| ValidationPanel実装 | ⬜ | - | - | エラー一覧表示 |
| Exportボタンの有効/無効制御 | ⬜ | - | - | エラー時は無効 |

### 4.6 Export実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| Canvas状態→strategy_config.json変換 | ⬜ | - | - | - |
| meta.formatVersion設定 | ⬜ | - | - | "1.0" |
| globalGuards設定 | ⬜ | - | - | M1/shift=1/noReentry固定 |
| strategies[]生成 | ⬜ | - | - | priority/entryRequirement等 |
| blocks[]生成 | ⬜ | - | - | typeId/params |
| profiles/<name>.json出力 | ⬜ | - | - | 保存用 |
| active.json出力 | ⬜ | - | - | EA実行用 |
| ファイル配置（MT5のMQL5/Files/strategy/） | ⬜ | - | - | - |

### 4.7 Load/Save実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| profiles/<name>.json読み込み | ⬜ | - | - | - |
| Canvas状態の復元 | ⬜ | - | - | ノード配置・パラメータ |
| 保存ダイアログ実装 | ⬜ | - | - | - |
| 読み込みダイアログ実装 | ⬜ | - | - | - |

### 4.8 Phase 2完了確認

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| ブロックを配置できるか確認 | ⬜ | - | - | - |
| パラメータを設定できるか確認 | ⬜ | - | - | - |
| バリデーションが機能するか確認 | ⬜ | - | - | AC-06/23/24/25 |
| active.jsonを出力できるか確認 | ⬜ | - | - | - |
| 出力したJSONがEAで読み込めるか確認 | ⬜ | - | - | - |
| Phase 3開始承認 | ⬜ | PM | - | - |

**Phase 2完了日**: ___________

---

## 5. Phase 3: 統合検証

**目的**: GUI出力→EA読込→バックテストの一連動作を検証

**開始条件**: Phase 1 + Phase 2完了

**完了条件**:
- 受入基準AC-01〜AC-11が達成
- 代表シナリオで再現性が確認される

### 5.1 統合環境の準備

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| MT5バックテスト環境の準備 | ⬜ | - | - | Strategy Tester設定 |
| テストデータの準備 | ⬜ | - | - | 2024-01-01〜2024-01-31 |
| 検証スクリプトの準備（Python等） | ⬜ | - | - | JSONL解析スクリプト |
| 代表シナリオの定義 | ⬜ | - | - | 3-5パターン |

### 5.2 Critical受入基準の検証（AC-01〜AC-11）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| AC-01: エントリー評価タイミング（M1新バーのみ） | ⬜ | - | - | BAR_EVAL_START 1分間隔 |
| AC-02: 同一足再エントリー禁止 | ⬜ | - | - | ORDER_REJECT確認 |
| AC-03: OR/AND短絡評価の動作確認 | ⬜ | - | - | ログで短絡確認 |
| AC-04: ポジション制限超過時の挙動 | ⬜ | - | - | LIMIT_EXCEEDED確認 |
| AC-05: スプレッド超過時の停止 | ⬜ | - | - | filter.spreadMax FAIL |
| AC-06: GUI側バリデーション（必須パラメータ） | ⬜ | - | - | Export抑止確認 |
| AC-07: EA側バリデーション（formatVersion非互換） | ⬜ | - | - | INIT_FAILED確認 |
| AC-08: ブロック参照切れの検出（EA側） | ⬜ | - | - | INIT_FAILED確認 |
| AC-09: インジケータ取得失敗時の安全側停止 | ⬜ | - | - | BLOCK_EVAL FAIL |
| AC-10: ブロック判定理由がログに残る | ⬜ | - | - | reason文字列確認 |
| AC-11: 発注失敗理由がログに残る | ⬜ | - | - | ORDER_REJECT確認 |

### 5.3 再現性検証（AC-28）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| 同一設定・同一期間で2回バックテスト実行 | ⬜ | - | - | - |
| Total Trades一致確認 | ⬜ | - | - | - |
| Profit一致確認 | ⬜ | - | - | - |
| ログファイル内容一致確認 | ⬜ | - | - | エントリー時刻・価格 |

### 5.4 代表シナリオの検証

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| シナリオ1: 基本エントリー（Spread+Session+MA+BB） | ⬜ | - | - | MVPブロック全使用 |
| シナリオ2: OR評価（2つのRuleGroup） | ⬜ | - | - | 短絡評価確認 |
| シナリオ3: ポジション制限（maxPositionsTotal=1） | ⬜ | - | - | 2回目拒否確認 |
| シナリオ4: スプレッド停止 | ⬜ | - | - | 広スプレッド時の停止 |
| シナリオ5: 設定エラー（formatVersion非互換） | ⬜ | - | - | 起動失敗確認 |

### 5.5 問題の修正

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| 検証で見つかった問題のリスト化 | ⬜ | - | - | - |
| 優先度付け | ⬜ | - | - | Critical/High/Medium |
| Critical問題の修正 | ⬜ | - | - | - |
| High問題の修正 | ⬜ | - | - | - |
| 再検証 | ⬜ | - | - | - |

### 5.6 Phase 3完了確認

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| AC-01〜AC-11が全て達成されているか確認 | ⬜ | - | - | - |
| 再現性が確認されているか確認 | ⬜ | - | - | AC-28 |
| 代表シナリオが全て成功しているか確認 | ⬜ | - | - | - |
| Critical問題がゼロか確認 | ⬜ | - | - | - |
| Phase 4開始承認 | ⬜ | PM | - | - |

**Phase 3完了日**: ___________

---

## 6. Phase 4: 安全装置・運用強化

**目的**: リスクガード、ナンピン安全装置、運用マニュアルを整備

**開始条件**: Phase 3完了

**完了条件**:
- リスクガードが機能
- 運用マニュアルが整備
- AC-12〜AC-22の受入基準達成（優先度Highのみ）

### 6.1 リスクガード実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| 最大ロット制限（globalGuards.maxLotTotal） | ⬜ | - | - | AC-19対応 |
| クールダウン（連続発注抑制） | ⬜ | - | - | - |
| 異常検知（ポジション数異常等） | ⬜ | - | - | AC-22対応 |
| 緊急停止機能 | ⬜ | - | - | AC-22対応 |
| ログ出力（GUARD_TRIGGERED、EMERGENCY_STOP） | ⬜ | - | - | - |

### 6.2 ナンピン機能実装（Phase 4で追加）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| nanpinModel詳細仕様の確定 | ⬜ | - | - | 追加条件、maxCount等 |
| ナンピン追加エントリー実装 | ⬜ | - | - | - |
| 最大段数制限 | ⬜ | - | - | AC-12対応 |
| シリーズ損切り実装 | ⬜ | - | - | AC-13対応 |
| 最大時BE決済実装 | ⬜ | - | - | AC-14対応 |
| ログ出力（NANPIN_ACTION） | ⬜ | - | - | - |

### 6.3 ExitModel拡張実装

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| exit.trailing実装 | ⬜ | - | - | AC-21対応 |
| exit.breakeven実装 | ⬜ | - | - | - |
| exit.weekend実装 | ⬜ | - | - | AC-20対応 |
| exit.avgProfit実装 | ⬜ | - | - | - |
| ログ出力（MANAGEMENT_ACTION、POSITION_CLOSE） | ⬜ | - | - | - |

### 6.4 運用マニュアル整備

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| active.json差し替え手順の文書化 | ⬜ | - | - | 99_runbook.md更新 |
| パラメータ変更手順の文書化 | ⬜ | - | - | - |
| EA起動・停止手順の文書化 | ⬜ | - | - | - |
| ログ確認手順の文書化 | ⬜ | - | - | - |
| トラブルシュート手順の文書化 | ⬜ | - | - | - |
| バックアップ・復旧手順の文書化 | ⬜ | - | - | - |
| 定期メンテナンス手順の文書化 | ⬜ | - | - | ログローテーション等 |

### 6.5 High優先度受入基準の検証（AC-12〜AC-19）

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| AC-12: ナンピン最大段数制限 | ⬜ | - | - | - |
| AC-13: ナンピンシリーズ損切り | ⬜ | - | - | - |
| AC-14: ナンピン最大時BE決済 | ⬜ | - | - | - |
| AC-15: ブローカー制約チェック（最小ロット） | ⬜ | - | - | Phase 1で実装済み |
| AC-16: ブローカー制約チェック（ストップレベル） | ⬜ | - | - | Phase 1で実装済み |
| AC-17: セッションフィルタの動作 | ⬜ | - | - | Phase 1で実装済み |
| AC-18: Strategy優先度順評価 | ⬜ | - | - | Phase 1で実装済み |
| AC-19: ロット制限超過時の停止 | ⬜ | - | - | - |

### 6.6 Phase 4完了確認

| タスク | 状態 | 担当 | 完了日 | Notes |
|--------|------|------|--------|-------|
| リスクガードが機能するか確認 | ⬜ | - | - | - |
| ナンピン安全装置が機能するか確認 | ⬜ | - | - | AC-12/13/14 |
| 運用マニュアルが整備されているか確認 | ⬜ | - | - | 99_runbook.md |
| High優先度受入基準が達成されているか確認 | ⬜ | - | - | AC-12〜AC-19 |
| MVP完了承認 | ⬜ | PM | - | - |

**Phase 4完了日**: ___________

---

## 7. MVP完了確認

### 7.1 最終チェックリスト

| 項目 | 状態 | 完了日 | Notes |
|------|------|--------|-------|
| Phase 0: 契約確定完了 | ⬜ | - | - |
| Phase 1: EA Runtime MVP完了 | ⬜ | - | - |
| Phase 2: GUI Builder MVP完了 | ⬜ | - | - |
| Phase 3: 統合検証完了 | ⬜ | - | - |
| Phase 4: 安全装置・運用強化完了 | ⬜ | - | - |
| Critical受入基準（AC-01〜AC-11）達成 | ⬜ | - | - |
| High優先度受入基準（AC-12〜AC-19）達成 | ⬜ | - | - |
| 運用マニュアル整備完了 | ⬜ | - | - |
| 全ドキュメント最終レビュー完了 | ⬜ | - | - |

### 7.2 MVP完了判定

**MVP完了日**: ___________

**MVP完了承認**: ___________

**次のステップ**: Phase 5以降の拡張機能実装（Strategy競合解決拡張、ナンピン詳細仕様、ルール合成拡張等）

---

## 8. 参照ドキュメント

本MVPチェックリストは以下のドキュメントを基に作成されています：

- `docs/00_overview.md` - 合意事項・前提条件
- `docs/05_development_plan/10_development_plan.md` - 開発計画
- `docs/02_requirements/12_acceptance_criteria.md` - 受入基準
- `docs/03_design/45_interface_contracts.md` - インターフェース契約
- `docs/04_operations/85_log_event_spec.md` - ログイベント仕様

---

## 9. 変更履歴

| 版 | 日付 | 変更内容 |
|----|------|---------|
| v1.0 | 2026-01-22 | 初版作成、Phase 0-4の全タスクをリスト化 |

---
